<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>fcms.resources.collection documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Falkland-cms 0.3.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><a href="index.html"><span class="inner">Namespaces</span></a></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fcms</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resources</span></div></div></li><li class="depth-3 branch current"><a href="fcms.resources.collection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>collection</span></div></a></li><li class="depth-3 branch"><a href="fcms.resources.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-3 branch"><a href="fcms.resources.item.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>item</span></div></a></li><li class="depth-3"><a href="fcms.resources.taxonomy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>taxonomy</span></div></a></li></ul></div><div class="sidebar" id="vars"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="fcms.resources.collection.html#var-all-collections"><div class="inner"><span>all-collections</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-collection-count"><div class="inner"><span>collection-count</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-create-collection"><div class="inner"><span>create-collection</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-delete-collection"><div class="inner"><span>delete-collection</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-get-collection"><div class="inner"><span>get-collection</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-item-count"><div class="inner"><span>item-count</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-update-collection"><div class="inner"><span>update-collection</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-valid-collection-update"><div class="inner"><span>valid-collection-update</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-valid-new-collection"><div class="inner"><span>valid-new-collection</span></div></a></li><li class="depth-1"><a href="fcms.resources.collection.html#var-with-collection"><div class="inner"><span>with-collection</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h2 class="anchor" id="top">fcms.resources.collection</h2><div class="doc"><div class="markdown"><p>A collection is a container for all the items that you&rsquo;d like to be organized and searched together.</p><p>A collection may have none, one or many taxonomies and they are independent of each other.</p></div></div><div class="public anchor" id="var-all-collections"><h3>all-collections</h3><div class="usage"><code>(all-collections)</code></div><div class="doc"><div class="markdown"><p>Return all the collections in the system as a sequence of maps.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L177">view source</a></div></div><div class="public anchor" id="var-collection-count"><h3>collection-count</h3><div class="usage"><code>(collection-count)</code></div><div class="doc"><div class="markdown"><p>Return the number of collections in the system.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L183">view source</a></div></div><div class="public anchor" id="var-create-collection"><h3>create-collection</h3><div class="usage"><code>(create-collection collection-name)</code><code>(create-collection collection-name properties)</code></div><div class="doc"><div class="markdown"><p>Create a new collection using the specified name and an optional map of properties.</p><p>If a <code>:slug</code> is included in the properties it will be used as the collection&rsquo;s slug, otherwise a slug will be created from the name.</p><p>The same validity conditions and invalid return values as the <code>valid-new-collection</code> function apply.</p><p>If everything is OK, a map representing the newly created collection is returned.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L62">view source</a></div></div><div class="public anchor" id="var-delete-collection"><h3>delete-collection</h3><div class="usage"><code>(delete-collection slug)</code></div><div class="doc"><div class="markdown"><p>Given the slug of the collection, delete it and all its contents and return <code>true</code>, or return <code>:bad-collection</code> if no collection exists for the specified slug.</p><p>If any portion of the bulk delete fails then the raw Couch DB bulk update response is returned.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L90">view source</a></div></div><div class="public anchor" id="var-get-collection"><h3>get-collection</h3><div class="usage"><code>(get-collection slug)</code></div><div class="doc"><div class="markdown"><p>Given the slug of the collection, return the collection as a map, or <code>nil</code> if there&rsquo;s no collection with the specified slug.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L21">view source</a></div></div><div class="public anchor" id="var-item-count"><h3>item-count</h3><div class="usage"><code>(item-count slug)</code></div><div class="doc"><div class="markdown"><p>Given the slug of the collection, return the number of items it contains, or return <code>:bad-collection</code> if there is no collection with the specified slug.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L168">view source</a></div></div><div class="public anchor" id="var-update-collection"><h3>update-collection</h3><div class="usage"><code>(update-collection slug properties)</code></div><div class="doc"><div class="markdown"><p>Update the collection specified by its slug using the specified map of properties.</p><p>If <code>:slug</code> is included in the properties the item will be moved to the new slug, otherwise the slug will remain the same.</p><p>The same validity conditions and invalid return values as the <code>valid-collection-update</code> function apply.</p><p>If everything is OK, a map representing the newly updated collection is returned.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L139">view source</a></div></div><div class="public anchor" id="var-valid-collection-update"><h3>valid-collection-update</h3><div class="usage"><code>(valid-collection-update slug properties)</code></div><div class="doc"><div class="markdown"><p>Given the slug of the collection, and a map of updated properties for the collection, checks if the everything is in order to update the collection.</p><p>Ensures the collection exists or returns <code>:bad-collection</code>.</p><p>Ensures no reserved properties from <code>common/reserved-properties</code> are used or returns <code>:property-conflict</code>.</p><p>If a new slug is provided in the properties, ensures it is valid and unused or returns <code>:invalid-slug</code> or <code>:slug-conflict</code> respectively.</p><p>If everything is OK with the proposed update, <code>true</code> is returned.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L104">view source</a></div></div><div class="public anchor" id="var-valid-new-collection"><h3>valid-new-collection</h3><div class="usage"><code>(valid-new-collection collection-name)</code><code>(valid-new-collection collection-name properties)</code></div><div class="doc"><div class="markdown"><p>Given the name of a new collection, and a map of the new collection&rsquo;s properties, check if the everything is in order to create the new collection.</p><p>Ensures the name of the item is specified or returns <code>:no-name</code>.</p><p>Ensures the slug is valid and doesn&rsquo;t already exist if it&rsquo;s specified, or returns <code>:invalid-slug</code> or <code>:slug-conflict</code> respectively.</p><p>If a property is included in the map of properties that is in the <code>common/reserved-properties</code> set of reserved property names <code>:property-conflict</code> is returned.</p><p>If everything is OK with the proposed new collection, <code>true</code> is returned.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L37">view source</a></div></div><div class="public anchor" id="var-with-collection"><h3>with-collection</h3><h4 class="type">macro</h4><div class="usage"><code>(with-collection slug &amp; body)</code></div><div class="doc"><div class="markdown"><p>Given the slug of a collection, execute the code in the body with the retrieved collection lexically scoped as <code>collection</code>, or return <code>:bad-collection</code> if there is no collection with the specified slug.</p></div></div><div class="src-link"><a href="http://github.com/SnootyMonkey/Falkland-CMS/blob/master/src/fcms/resources/collection.clj#L158">view source</a></div></div></div></body></html>